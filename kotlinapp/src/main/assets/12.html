<!DOCTYPE html>
<!-- saved from url=(0053)http://www.runoob.com/kotlin/kotlin-basic-syntax.html -->
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Kotlin 扩展</title>

	  <link rel="dns-prefetch" href="http://s.w.org/">

		<link rel="stylesheet" href="./css2/style.css" type="text/css" media="all">
		<link rel="stylesheet" href="./css2/font-awesome.min.css" media="all">
		<link rel="stylesheet" type="text/css" href="./css2/prettify.css">
	</head>
<body style="">

<!--  头部 -->

<!-- 导航栏 -->

<div class="container main">
	<!-- 中间 -->
	<div class="row">

<div class="col left-column">

	<div class="sidebar-box gallery-list">

	</div>
</div>
<div class="col middle-column">

<div class="article">
		
		<div class="article-body">

			<div class="article-intro" id="content">

			<h1>Kotlin 扩展</h1>
<p>Kotlin 可以对一个类的属性和方法进行扩展，且不需要继承或使用 Decorator 模式。</p>
<p>扩展是一种静态行为，对被扩展的类代码本身不会造成任何影响。</p>
<hr>
<h2>扩展函数</h2>
<p>扩展函数可以在已有类中添加新的方法，不会对原类做修改，扩展函数定义形式：</p>
<pre class="prettyprint prettyprinted" style=""><span class="pln">fun receiverType</span><span class="pun">.</span><span class="pln">functionName</span><span class="pun">(</span><span class="kwd">params</span><span class="pun">){</span><span class="pln">
    body
</span><span class="pun">}</span></pre>
<ul>
<li>receiverType：表示函数的接收者，也就是函数扩展的对象</li>
<li>functionName：扩展函数的名称</li>
<li>params：扩展函数的参数，可以为NULL</li>
</ul>
<p>以下实例扩展 User 类 ：</p>
<pre class="prettyprint prettyprinted" style=""><span class="kwd">class</span><span class="pln"> </span><span class="typ">User</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> name</span><span class="pun">:</span><span class="typ">String</span><span class="pun">)</span><span class="pln">

</span><span class="com">/**扩展函数**/</span><span class="pln">
fun </span><span class="typ">User</span><span class="pun">.</span><span class="typ">Print</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"用户名 $name"</span><span class="pun">)</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

fun main</span><span class="pun">(</span><span class="pln">arg</span><span class="pun">:</span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;){</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> user </span><span class="pun">=</span><span class="pln"> </span><span class="typ">User</span><span class="pun">(</span><span class="str">"Runoob"</span><span class="pun">)</span><span class="pln">
    user</span><span class="pun">.</span><span class="typ">Print</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span></pre><p>实例执行输出结果为：</p>
<pre class="prettyprint prettyprinted" style=""><span class="pun">用户名</span><span class="pln"> </span><span class="typ">Runoob</span></pre>
<p>下面代码为 MutableList<int> 添加一个swap 函数：</int></p>
<pre class="prettyprint prettyprinted" style=""><span class="com">// 扩展函数 swap,调换不同位置的值</span><span class="pln">
fun </span><span class="typ">MutableList</span><span class="pun">&lt;</span><span class="typ">Int</span><span class="pun">&gt;.</span><span class="pln">swap</span><span class="pun">(</span><span class="pln">index1</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">,</span><span class="pln"> index2</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    val tmp </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">[</span><span class="pln">index1</span><span class="pun">]</span><span class="pln">     </span><span class="com">//  this 对应该列表</span><span class="pln">
    </span><span class="kwd">this</span><span class="pun">[</span><span class="pln">index1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">[</span><span class="pln">index2</span><span class="pun">]</span><span class="pln">
    </span><span class="kwd">this</span><span class="pun">[</span><span class="pln">index2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmp
</span><span class="pun">}</span><span class="pln">

fun main</span><span class="pun">(</span><span class="pln">args</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    val l </span><span class="pun">=</span><span class="pln"> mutableListOf</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln">
    </span><span class="com">// 位置 0 和 2 的值做了互换</span><span class="pln">
    l</span><span class="pun">.</span><span class="pln">swap</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="com">// 'swap()' 函数内的 'this' 将指向 'l' 的值</span><span class="pln">

    println</span><span class="pun">(</span><span class="pln">l</span><span class="pun">.</span><span class="pln">toString</span><span class="pun">())</span><span class="pln">
</span><span class="pun">}</span></pre>
<p>实例执行输出结果为：</p>
<pre class="prettyprint prettyprinted" style=""><span class="pun">[</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span></pre>
<p>this关键字指代接收者对象(receiver object)(也就是调用扩展函数时, 在点号之前指定的对象实例)。</p>
<hr>
<h2>扩展函数是静态解析的

</h2>
<p>扩展函数是静态解析的，并不是接收者类型的虚拟成员，在调用扩展函数时，具体被调用的的是哪一个函数，由调用函数的的对象表达式来决定的，而不是动态的类型决定的:</p>
<pre class="prettyprint prettyprinted" style=""><span class="pln">open </span><span class="kwd">class</span><span class="pln"> C

</span><span class="kwd">class</span><span class="pln"> D</span><span class="pun">:</span><span class="pln"> C</span><span class="pun">()</span><span class="pln">

fun C</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"c"</span><span class="pln">   </span><span class="com">// 扩展函数 foo</span><span class="pln">

fun D</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"d"</span><span class="pln">   </span><span class="com">// 扩展函数 foo</span><span class="pln">

fun printFoo</span><span class="pun">(</span><span class="pln">c</span><span class="pun">:</span><span class="pln"> C</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    println</span><span class="pun">(</span><span class="pln">c</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">())</span><span class="pln">  </span><span class="com">// 类型是 C 类</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

fun main</span><span class="pun">(</span><span class="pln">arg</span><span class="pun">:</span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;){</span><span class="pln">
    printFoo</span><span class="pun">(</span><span class="pln">D</span><span class="pun">())</span><span class="pln">
</span><span class="pun">}</span></pre>
<p>实例执行输出结果为：</p>
<pre class="prettyprint prettyprinted" style=""><span class="pln">c</span></pre>
<p>若扩展函数和成员函数一致，则使用该函数时，会优先使用成员函数。</p>
<pre class="prettyprint prettyprinted" style=""><span class="kwd">class</span><span class="pln"> C </span><span class="pun">{</span><span class="pln">
    fun foo</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> println</span><span class="pun">(</span><span class="str">"成员函数"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

fun C</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> println</span><span class="pun">(</span><span class="str">"扩展函数"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">

fun main</span><span class="pun">(</span><span class="pln">arg</span><span class="pun">:</span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;){</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> C</span><span class="pun">()</span><span class="pln">
    c</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span></pre><p>实例执行输出结果为：</p>
<pre class="prettyprint prettyprinted" style=""><span class="pun">成员函数</span></pre>
<h3>扩展一个空对象</h3>
<p>在扩展函数内， 可以通过 this 来判断接收者是否为 NULL,这样，即使接收者为 NULL,也可以调用扩展函数。例如:</p>
<pre class="prettyprint prettyprinted" style=""><span class="pln">fun </span><span class="typ">Any</span><span class="pun">?.</span><span class="pln">toString</span><span class="pun">():</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">this</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="str">"null"</span><span class="pln">
    </span><span class="com">// 空检测之后，“this”会自动转换为非空类型，所以下面的 toString()</span><span class="pln">
    </span><span class="com">// 解析为 Any 类的成员函数</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> toString</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
fun main</span><span class="pun">(</span><span class="pln">arg</span><span class="pun">:</span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;){</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> t </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pln">
    println</span><span class="pun">(</span><span class="pln">t</span><span class="pun">.</span><span class="pln">toString</span><span class="pun">())</span><span class="pln">
</span><span class="pun">}</span></pre><p>实例执行输出结果为：</p>
<pre class="prettyprint prettyprinted" style=""><span class="kwd">null</span></pre>
<hr>
&gt;扩展属性
<p>除了函数，Kotlin 也支持属性对属性进行扩展:</p>
<pre class="prettyprint prettyprinted" style=""><span class="pln">val </span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">List</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;.</span><span class="pln">lastIndex</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln">
    </span><span class="kwd">get</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> size </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
 </span></pre>
<p>扩展属性允许定义在类或者kotlin文件中，不允许定义在函数中。初始化属性因为属性没有后端字段（backing field），所以不允许被初始化，只能由显式提供的 getter/setter 定义。</p>
<pre class="prettyprint prettyprinted" style=""><span class="pln">val </span><span class="typ">Foo</span><span class="pun">.</span><span class="pln">bar </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="com">// 错误：扩展属性不能有初始化器</span></pre>
<p>扩展属性只能被声明为 val。</p>
<hr>
<h2>伴生对象的扩展</h2>
<p>如果一个类定义有一个伴生对象 ，你也可以为伴生对象定义扩展函数和属性。</p>

<p>伴生对象通过"类名."形式调用伴生对象，伴生对象声明的扩展函数，通过用类名限定符来调用：</p>
<pre class="prettyprint prettyprinted" style=""><span class="kwd">class</span><span class="pln"> </span><span class="typ">MyClass</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    companion </span><span class="kwd">object</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="pun">}</span><span class="pln">  </span><span class="com">// 将被称为 "Companion"</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

fun </span><span class="typ">MyClass</span><span class="pun">.</span><span class="typ">Companion</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    println</span><span class="pun">(</span><span class="str">"伴随对象的扩展函数"</span><span class="pun">)</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

val </span><span class="typ">MyClass</span><span class="pun">.</span><span class="typ">Companion</span><span class="pun">.</span><span class="kwd">no</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln">
    </span><span class="kwd">get</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10</span><span class="pln">

fun main</span><span class="pun">(</span><span class="pln">args</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    println</span><span class="pun">(</span><span class="str">"no:${MyClass.no}"</span><span class="pun">)</span><span class="pln">
    </span><span class="typ">MyClass</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span></pre><p>实例执行输出结果为：</p>
<pre class="prettyprint prettyprinted" style=""><span class="kwd">no</span><span class="pun">:</span><span class="lit">10</span><span class="pln">
</span><span class="pun">伴随对象的扩展函数</span></pre>
<hr>
<h2>扩展的作用域</h2>
<p>通常扩展函数或属性定义在顶级包下:</p>
<pre class="prettyprint prettyprinted" style=""><span class="kwd">package</span><span class="pln"> foo</span><span class="pun">.</span><span class="pln">bar

fun </span><span class="typ">Baz</span><span class="pun">.</span><span class="pln">goo</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="pun">……</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span></pre>
<p>要使用所定义包之外的一个扩展, 通过import导入扩展的函数名进行使用:</p>
<pre class="prettyprint prettyprinted" style=""><span class="kwd">package</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">example</span><span class="pun">.</span><span class="pln">usage

</span><span class="kwd">import</span><span class="pln"> foo</span><span class="pun">.</span><span class="pln">bar</span><span class="pun">.</span><span class="pln">goo </span><span class="com">// 导入所有名为 goo 的扩展</span><span class="pln">
                   </span><span class="com">// 或者</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> foo</span><span class="pun">.</span><span class="pln">bar</span><span class="pun">.*</span><span class="pln">   </span><span class="com">// 从 foo.bar 导入一切</span><span class="pln">

fun usage</span><span class="pun">(</span><span class="pln">baz</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Baz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    baz</span><span class="pun">.</span><span class="pln">goo</span><span class="pun">()</span><span class="pln">
</span><span class="pun">}</span></pre>
<hr>
<h2>扩展声明为成员</h2>
<p>在一个类内部你可以为另一个类声明扩展。</p>
<p>在这个扩展中，有个多个隐含的接受者，其中扩展方法定义所在类的实例称为分发接受者，而扩展方法的目标类型的实例称为扩展接受者。</p>
<pre class="prettyprint prettyprinted" style=""><span class="kwd">class</span><span class="pln"> D </span><span class="pun">{</span><span class="pln">
    fun bar</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> println</span><span class="pun">(</span><span class="str">"D bar"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">class</span><span class="pln"> C </span><span class="pun">{</span><span class="pln">
    fun baz</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> println</span><span class="pun">(</span><span class="str">"C baz"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">

    fun D</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        bar</span><span class="pun">()</span><span class="pln">   </span><span class="com">// 调用 D.bar</span><span class="pln">
        baz</span><span class="pun">()</span><span class="pln">   </span><span class="com">// 调用 C.baz</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    fun </span><span class="kwd">caller</span><span class="pun">(</span><span class="pln">d</span><span class="pun">:</span><span class="pln"> D</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        d</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">()</span><span class="pln">   </span><span class="com">// 调用扩展函数</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

fun main</span><span class="pun">(</span><span class="pln">args</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    val c</span><span class="pun">:</span><span class="pln"> C </span><span class="pun">=</span><span class="pln"> C</span><span class="pun">()</span><span class="pln">
    val d</span><span class="pun">:</span><span class="pln"> D </span><span class="pun">=</span><span class="pln"> D</span><span class="pun">()</span><span class="pln">
    c</span><span class="pun">.</span><span class="kwd">caller</span><span class="pun">(</span><span class="pln">d</span><span class="pun">)</span><span class="pln">

</span><span class="pun">}</span></pre><p>实例执行输出结果为：</p>
<pre class="prettyprint prettyprinted" style=""><span class="pln">D bar
C baz</span></pre><p>在 C 类内，创建了 D 类的扩展。此时，C 被成为分发接受者，而 D 为扩展接受者。从上例中，可以清楚的看到，在扩展函数中，可以调用派发接收者的成员函数。</p>
<p>假如在调用某一个函数，而该函数在分发接受者和扩展接受者均存在，则以扩展接收者优先，要引用分发接收者的成员你可以使用限定的 this 语法。</p>
<pre class="prettyprint prettyprinted" style=""><span class="kwd">class</span><span class="pln"> D </span><span class="pun">{</span><span class="pln">
    fun bar</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> println</span><span class="pun">(</span><span class="str">"D bar"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">class</span><span class="pln"> C </span><span class="pun">{</span><span class="pln">
    fun bar</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> println</span><span class="pun">(</span><span class="str">"C bar"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pln">  </span><span class="com">// 与 D 类 的 bar 同名</span><span class="pln">

    fun D</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        bar</span><span class="pun">()</span><span class="pln">         </span><span class="com">// 调用 D.bar()，扩展接收者优先</span><span class="pln">
        </span><span class="kwd">this</span><span class="lit">@C</span><span class="pun">.</span><span class="pln">bar</span><span class="pun">()</span><span class="pln">  </span><span class="com">// 调用 C.bar()</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    fun </span><span class="kwd">caller</span><span class="pun">(</span><span class="pln">d</span><span class="pun">:</span><span class="pln"> D</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        d</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">()</span><span class="pln">   </span><span class="com">// 调用扩展函数</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

fun main</span><span class="pun">(</span><span class="pln">args</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    val c</span><span class="pun">:</span><span class="pln"> C </span><span class="pun">=</span><span class="pln"> C</span><span class="pun">()</span><span class="pln">
    val d</span><span class="pun">:</span><span class="pln"> D </span><span class="pun">=</span><span class="pln"> D</span><span class="pun">()</span><span class="pln">
    c</span><span class="pun">.</span><span class="kwd">caller</span><span class="pun">(</span><span class="pln">d</span><span class="pun">)</span><span class="pln">

</span><span class="pun">}</span></pre><p>实例执行输出结果为：</p>
<pre class="prettyprint prettyprinted" style=""><span class="pln">D bar
C bar</span></pre>
<p>以成员的形式定义的扩展函数, 可以声明为 open , 而且可以在子类中覆盖. 也就是说, 在这类扩展函数的派
发过程中, 针对分发接受者是虚拟的(virtual), 但针对扩展接受者仍然是静态的。</p>
<pre class="prettyprint prettyprinted" style=""><span class="pln">open </span><span class="kwd">class</span><span class="pln"> D </span><span class="pun">{</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">class</span><span class="pln"> D1 </span><span class="pun">:</span><span class="pln"> D</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

open </span><span class="kwd">class</span><span class="pln"> C </span><span class="pun">{</span><span class="pln">
    open fun D</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        println</span><span class="pun">(</span><span class="str">"D.foo in C"</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    open fun D1</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        println</span><span class="pun">(</span><span class="str">"D1.foo in C"</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    fun </span><span class="kwd">caller</span><span class="pun">(</span><span class="pln">d</span><span class="pun">:</span><span class="pln"> D</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        d</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">()</span><span class="pln">   </span><span class="com">// 调用扩展函数</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">class</span><span class="pln"> C1 </span><span class="pun">:</span><span class="pln"> C</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">override</span><span class="pln"> fun D</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        println</span><span class="pun">(</span><span class="str">"D.foo in C1"</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">override</span><span class="pln"> fun D1</span><span class="pun">.</span><span class="pln">foo</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        println</span><span class="pun">(</span><span class="str">"D1.foo in C1"</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">


fun main</span><span class="pun">(</span><span class="pln">args</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    C</span><span class="pun">().</span><span class="kwd">caller</span><span class="pun">(</span><span class="pln">D</span><span class="pun">())</span><span class="pln">   </span><span class="com">// 输出 "D.foo in C"</span><span class="pln">
    C1</span><span class="pun">().</span><span class="kwd">caller</span><span class="pun">(</span><span class="pln">D</span><span class="pun">())</span><span class="pln">  </span><span class="com">// 输出 "D.foo in C1" —— 分发接收者虚拟解析</span><span class="pln">
    C</span><span class="pun">().</span><span class="kwd">caller</span><span class="pun">(</span><span class="pln">D1</span><span class="pun">())</span><span class="pln">  </span><span class="com">// 输出 "D.foo in C" —— 扩展接收者静态解析</span><span class="pln">

</span><span class="pun">}</span></pre><p>实例执行输出结果为：</p>
<pre class="prettyprint prettyprinted" style=""><span class="pln">D</span><span class="pun">.</span><span class="pln">foo </span><span class="kwd">in</span><span class="pln"> C
D</span><span class="pun">.</span><span class="pln">foo </span><span class="kwd">in</span><span class="pln"> C1
D</span><span class="pun">.</span><span class="pln">foo </span><span class="kwd">in</span><span class="pln"> C</span></pre>



			</div>
		</div>
	</div>
</div>

<!-- 右边栏 -->
<div class="fivecol last right-column">

<style>
.sidebar-tree .double-li {
	width:300px;
}
.sidebar-tree .double-li li {
    width: 44%;
    line-height: 1.5em;
    border-bottom: 1px solid #ccc;
    float: left;
    display: inline;
}
</style>

<style>
ol,ul{list-style:none}.cd-switcher a{text-decoration:none;outline:0}.cd-switcher a:hover{text-decoration:underline}a:focus{outline:0;-moz-outline:0}.main_nav{width:300px;height:60px;margin:60px auto 10px auto}.main_nav li{float:left;width:60px;margin-right:10px;font-size:16px;padding:.6em 1em;border-radius:3em;background:#2f889a;text-align:center}.main_nav li a{color:#fff}.errtip{background-color:#fceaea;color:#db5353;padding:8px 15px;font-size:14px;border:1px solid #fc9797;border-radius:5px}.cd-user-modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(52,54,66,0.9);z-index:3;overflow-y:auto;cursor:pointer;visibility:hidden;opacity:0;-webkit-transition:opacity .3s 0,visibility 0 .3s;-moz-transition:opacity .3s 0,visibility 0 .3s;transition:opacity .3s 0,visibility 0 .3s}.cd-user-modal.is-visible{visibility:visible;opacity:1;-webkit-transition:opacity .3s 0,visibility 0 0;-moz-transition:opacity .3s 0,visibility 0 0;transition:opacity .3s 0,visibility 0 0}.cd-user-modal.is-visible .cd-user-modal-container{-webkit-transform:translateY(0);-moz-transform:translateY(0);-ms-transform:translateY(0);-o-transform:translateY(0);transform:translateY(0)}.cd-user-modal-container{position:relative;width:90%;max-width:500px;background:#FFF;margin:3em auto 4em;cursor:auto;border-radius:.25em;-webkit-transform:translateY(-30px);-moz-transform:translateY(-30px);-ms-transform:translateY(-30px);-o-transform:translateY(-30px);transform:translateY(-30px);-webkit-transition-property:-webkit-transform;-moz-transition-property:-moz-transform;transition-property:transform;-webkit-transition-duration:.3s;-moz-transition-duration:.3s;transition-duration:.3s}.cd-user-modal-container .cd-switcher:after{content:"";display:table;clear:both}.cd-user-modal-container .cd-switcher li{width:50%;float:left;text-align:center}.cd-user-modal-container .cd-switcher li:first-child a{border-radius:.25em 0 0 0}.cd-user-modal-container .cd-switcher li:last-child a{border-radius:0 .25em 0 0}.cd-user-modal-container .cd-switcher a{font-size:1.2em;font-weight:bold;display:block;width:100%;height:50px;line-height:50px;background:#e8f1e2;color:#96b880}.cd-user-modal-container .cd-switcher a.selected{background:#FFF;color:#505260}@media only screen and (min-width:600px){.cd-user-modal-container{margin:4em auto}.cd-user-modal-container .cd-switcher a{height:70px;line-height:70px}}.cd-form{padding:1.4em}.cd-form .fieldset{position:relative;margin:1.4em 0}.cd-form .fieldset:first-child{margin-top:0}.cd-form .fieldset:last-child{margin-bottom:0}.cd-form label{font-size:16px;font-size:.875rem}.cd-form label.image-replace{display:inline-block;position:absolute;left:15px;top:50%;bottom:auto;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);-o-transform:translateY(-50%);transform:translateY(-50%);height:20px;width:20px;overflow:hidden;text-indent:100%;white-space:nowrap;color:transparent;text-shadow:none;background-repeat:no-repeat;background-position:50% 0}.cd-form label.cd-username{background-image:url("/wp-content/themes/runoob/assets/img/cd-icon-username.svg")}.cd-form label.cd-email{background-image:url("/wp-content/themes/runoob/assets/img/cd-icon-email.svg")}.cd-form label.cd-password{background-image:url("/wp-content/themes/runoob/assets/img/cd-icon-password.svg")}.cd-form input{margin:0;padding:0;border-radius:.25em}.cd-form input.full-width{width:80%}.cd-form input.full-width2{width:94%}.cd-form input.has-padding{padding:12px 20px 12px 50px}.cd-form input.has-border{border:1px solid #d2d8d8;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;-o-appearance:none;appearance:none}.cd-form input.has-border:focus{border-color:#98b880;box-shadow:0 0 5px rgba(52,54,66,0.1);outline:0}.cd-form input.has-error{border:1px solid #d76666}.cd-form input[type=password]{padding-right:65px}.cd-form input[type=submit]{padding:16px 0;cursor:pointer;background:#96b97d;color:#FFF;font-weight:bold;border:0;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;-o-appearance:none;appearance:none;font-size:1.2em;font-weight:bold}.no-touch .cd-form input[type=submit]:hover,.no-touch .cd-form input[type=submit]:focus{background:#3599ae;outline:0}@media only screen and (min-width:600px){.cd-form{padding:2em}.cd-form .fieldset{margin:2em 0}.cd-form .fieldset:first-child{margin-top:0}.cd-form .fieldset:last-child{margin-bottom:0}.cd-form input.has-padding{padding:16px 20px 16px 50px}.cd-form input[type=submit]{padding:16px 0}}.cd-close-form{display:block;position:absolute;width:40px;height:40px;right:0;top:-40px;background:url("/wp-content/themes/runoob/assets/img/cd-icon-close.svg") no-repeat center center;text-indent:100%;white-space:nowrap;overflow:hidden}@media only screen and (min-width:1170px){}#cd-login,#cd-signup,#cd-reset-password{display:none}#cd-login.is-selected,#cd-signup.is-selected,#cd-reset-password.is-selected{display:block}
</style>


</body></html>
