<!DOCTYPE html>
<!-- saved from url=(0053)http://www.runoob.com/kotlin/kotlin-basic-syntax.html -->
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Kotlin 数据类与密封类</title>

	  <link rel="dns-prefetch" href="http://s.w.org/">

		<link rel="stylesheet" href="./css2/style.css" type="text/css" media="all">
		<link rel="stylesheet" href="./css2/font-awesome.min.css" media="all">
		<link rel="stylesheet" type="text/css" href="./css2/prettify.css">
	</head>
<body style="">

<!--  头部 -->

<!-- 导航栏 -->

<div class="container main">
	<!-- 中间 -->
	<div class="row">

<div class="col left-column">

	<div class="sidebar-box gallery-list">

	</div>
</div>
<div class="col middle-column">

<div class="article">
			<div class="article-heading-ad" style="display: none;">

		</div>

		<div class="article-body">

			<div class="article-intro" id="content">

			<h1>Kotlin 数据类与密封类</h1>
<hr><h2>数据类</h2>
<p>Kotlin 可以创建一个只包含数据的类，关键字为 <span class="marked">data</span>：</p>
<pre class="prettyprint prettyprinted" style=""><span class="pln">data </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">User</span><span class="pun">(</span><span class="pln">val name</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pun">,</span><span class="pln"> val age</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span></pre>
<p>编译器会自动的从主构造函数中根据所有声明的属性提取以下函数：</p>

<ul>
<li>
<code>equals()</code> / <code>hashCode()</code> </li>
<li>
<code>toString()</code>  格式如 <code>"User(name=John, age=42)"</code> </li>
<li>
<code>componentN() functions</code> 对应于属性，按声明顺序排列</li>
<li>
<code>copy()</code> 函数 </li>
</ul>
<p>
如果这些函数在类中已经被明确定义了，或者从超类中继承而来，就不再会生成。
</p><p>
为了保证生成代码的一致性以及有意义，数据类需要满足以下条件：</p>
<ul>
<li><p>主构造函数至少包含一个参数。 </p></li>
<li><p>所有的主构造函数的参数必须标识为<code>val</code> 或者 <code>var</code> ;</p></li>
<li><p>数据类不可以声明为 <code>abstract</code>, <code>open</code>, <code>sealed</code> 或者 <code>inner</code>;</p></li>
<li><p>数据类不能继承其他类 (但是可以实现接口)。</p><pre class="prettyprint prettyprinted" style=""><span class="pln">fun copy</span><span class="pun">(</span><span class="pln">name</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name</span><span class="pun">,</span><span class="pln"> age</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">age</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">User</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="pln"> age</span><span class="pun">)</span></pre>
</li>
</ul>

<h3>复制</h3>
<p>复制使用 copy() 函数，我们可以使用该函数复制对象并修改部分属性, 对于上文的 User 类，其实现会类似下面这样：</p>
<pre class="prettyprint prettyprinted" style=""><span class="pln">fun copy</span><span class="pun">(</span><span class="pln">name</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name</span><span class="pun">,</span><span class="pln"> age</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">age</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">User</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="pln"> age</span><span class="pun">)</span></pre>
<h3>实例</h3>
<p>使用 copy 类复制 User 数据类，并修改 age 属性:</p>
<pre class="prettyprint prettyprinted" style=""><span class="pln">data </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">User</span><span class="pun">(</span><span class="pln">val name</span><span class="pun">:</span><span class="pln"> </span><span class="typ">String</span><span class="pun">,</span><span class="pln"> val age</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">)</span><span class="pln">


fun main</span><span class="pun">(</span><span class="pln">args</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Array</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    val jack </span><span class="pun">=</span><span class="pln"> </span><span class="typ">User</span><span class="pun">(</span><span class="pln">name </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Jack"</span><span class="pun">,</span><span class="pln"> age </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    val olderJack </span><span class="pun">=</span><span class="pln"> jack</span><span class="pun">.</span><span class="pln">copy</span><span class="pun">(</span><span class="pln">age </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
    println</span><span class="pun">(</span><span class="pln">jack</span><span class="pun">)</span><span class="pln">
    println</span><span class="pun">(</span><span class="pln">olderJack</span><span class="pun">)</span><span class="pln">

</span><span class="pun">}</span></pre>
<p>输出结果为：</p>
<pre class="prettyprint prettyprinted" style=""><span class="typ">User</span><span class="pun">(</span><span class="pln">name</span><span class="pun">=</span><span class="typ">Jack</span><span class="pun">,</span><span class="pln"> age</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
</span><span class="typ">User</span><span class="pun">(</span><span class="pln">name</span><span class="pun">=</span><span class="typ">Jack</span><span class="pun">,</span><span class="pln"> age</span><span class="pun">=</span><span class="lit">2</span><span class="pun">)</span></pre>

<h3>数据类以及解构声明</h3>
<p>组件函数允许数据类在解构声明中使用：</p>
<pre class="prettyprint prettyprinted" style=""><span class="pln">val jane </span><span class="pun">=</span><span class="pln"> </span><span class="typ">User</span><span class="pun">(</span><span class="str">"Jane"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">35</span><span class="pun">)</span><span class="pln">
val </span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="pln"> age</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> jane
println</span><span class="pun">(</span><span class="str">"$name, $age years of age"</span><span class="pun">)</span><span class="pln"> </span><span class="com">// prints "Jane, 35 years of age"</span></pre>

<h3>标准数据类</h3><p>标准库提供了  <span class="marked">Pair</span>  和  <span class="marked">Triple</span> 。在大多数情形中，命名数据类是更好的设计选择，因为这样代码可读性更强而且提供了有意义的名字和属性。</p>

<hr>
<h2>密封类</h2>
<p>密封类用来表示受限的类继承结构：当一个值为有限集中的类型, 而不能有任何其他类型时。在某种意义上，他们是枚举类的扩展：枚举类型的值集合 也是受限的，但每个枚举常量只存在一个实例，而密封类 的一个子类可以有可包含状态的多个实例。</p>
<p>
声明一个密封类，使用 <span class="marked">sealed</span> 修饰类，密封类可以有子类，但是所有的子类都必须要内嵌在密封类中。
</p><p>
sealed 不能修饰 interface ,abstract class(会报 warning,但是不会出现编译错误)</p>
<pre class="prettyprint prettyprinted" style=""><span class="kwd">sealed</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Expr</span><span class="pln">
data </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Const</span><span class="pun">(</span><span class="pln">val number</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Double</span><span class="pun">)</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="typ">Expr</span><span class="pun">()</span><span class="pln">
data </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Sum</span><span class="pun">(</span><span class="pln">val e1</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Expr</span><span class="pun">,</span><span class="pln"> val e2</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Expr</span><span class="pun">)</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="typ">Expr</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">object</span><span class="pln"> </span><span class="typ">NotANumber</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="typ">Expr</span><span class="pun">()</span><span class="pln">

fun </span><span class="kwd">eval</span><span class="pun">(</span><span class="pln">expr</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Expr</span><span class="pun">):</span><span class="pln"> </span><span class="typ">Double</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">when</span><span class="pln"> </span><span class="pun">(</span><span class="pln">expr</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">Const</span><span class="pln"> </span><span class="pun">-&gt;</span><span class="pln"> expr</span><span class="pun">.</span><span class="pln">number
    </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">Sum</span><span class="pln"> </span><span class="pun">-&gt;</span><span class="pln"> </span><span class="kwd">eval</span><span class="pun">(</span><span class="pln">expr</span><span class="pun">.</span><span class="pln">e1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">eval</span><span class="pun">(</span><span class="pln">expr</span><span class="pun">.</span><span class="pln">e2</span><span class="pun">)</span><span class="pln">
    </span><span class="typ">NotANumber</span><span class="pln"> </span><span class="pun">-&gt;</span><span class="pln"> </span><span class="typ">Double</span><span class="pun">.</span><span class="kwd">NaN</span><span class="pln">
</span><span class="pun">}</span></pre><p>使用密封类的关键好处在于使用 when 表达式 的时候，如果能够 验证语句覆盖了所有情况，就不需要为该语句再添加一个 else 子句了。</p>
<pre class="prettyprint prettyprinted" style=""><span class="pln">fun </span><span class="kwd">eval</span><span class="pun">(</span><span class="pln">expr</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Expr</span><span class="pun">):</span><span class="pln"> </span><span class="typ">Double</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">when</span><span class="pun">(</span><span class="pln">expr</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">Expr</span><span class="pun">.</span><span class="typ">Const</span><span class="pln"> </span><span class="pun">-&gt;</span><span class="pln"> expr</span><span class="pun">.</span><span class="pln">number
    </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">Expr</span><span class="pun">.</span><span class="typ">Sum</span><span class="pln"> </span><span class="pun">-&gt;</span><span class="pln"> </span><span class="kwd">eval</span><span class="pun">(</span><span class="pln">expr</span><span class="pun">.</span><span class="pln">e1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">eval</span><span class="pun">(</span><span class="pln">expr</span><span class="pun">.</span><span class="pln">e2</span><span class="pun">)</span><span class="pln">
    </span><span class="typ">Expr</span><span class="pun">.</span><span class="typ">NotANumber</span><span class="pln"> </span><span class="pun">-&gt;</span><span class="pln"> </span><span class="typ">Double</span><span class="pun">.</span><span class="kwd">NaN</span><span class="pln">
    </span><span class="com">// 不再需要 `else` 子句，因为我们已经覆盖了所有的情况</span><span class="pln">
</span><span class="pun">}</span></pre>

			</div>
		</div>
	</div>
</div>

<!-- 右边栏 -->
<div class="fivecol last right-column">

<style>
.sidebar-tree .double-li {
	width:300px;
}
.sidebar-tree .double-li li {
    width: 44%;
    line-height: 1.5em;
    border-bottom: 1px solid #ccc;
    float: left;
    display: inline;
}
</style>

<style>
ol,ul{list-style:none}.cd-switcher a{text-decoration:none;outline:0}.cd-switcher a:hover{text-decoration:underline}a:focus{outline:0;-moz-outline:0}.main_nav{width:300px;height:60px;margin:60px auto 10px auto}.main_nav li{float:left;width:60px;margin-right:10px;font-size:16px;padding:.6em 1em;border-radius:3em;background:#2f889a;text-align:center}.main_nav li a{color:#fff}.errtip{background-color:#fceaea;color:#db5353;padding:8px 15px;font-size:14px;border:1px solid #fc9797;border-radius:5px}.cd-user-modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(52,54,66,0.9);z-index:3;overflow-y:auto;cursor:pointer;visibility:hidden;opacity:0;-webkit-transition:opacity .3s 0,visibility 0 .3s;-moz-transition:opacity .3s 0,visibility 0 .3s;transition:opacity .3s 0,visibility 0 .3s}.cd-user-modal.is-visible{visibility:visible;opacity:1;-webkit-transition:opacity .3s 0,visibility 0 0;-moz-transition:opacity .3s 0,visibility 0 0;transition:opacity .3s 0,visibility 0 0}.cd-user-modal.is-visible .cd-user-modal-container{-webkit-transform:translateY(0);-moz-transform:translateY(0);-ms-transform:translateY(0);-o-transform:translateY(0);transform:translateY(0)}.cd-user-modal-container{position:relative;width:90%;max-width:500px;background:#FFF;margin:3em auto 4em;cursor:auto;border-radius:.25em;-webkit-transform:translateY(-30px);-moz-transform:translateY(-30px);-ms-transform:translateY(-30px);-o-transform:translateY(-30px);transform:translateY(-30px);-webkit-transition-property:-webkit-transform;-moz-transition-property:-moz-transform;transition-property:transform;-webkit-transition-duration:.3s;-moz-transition-duration:.3s;transition-duration:.3s}.cd-user-modal-container .cd-switcher:after{content:"";display:table;clear:both}.cd-user-modal-container .cd-switcher li{width:50%;float:left;text-align:center}.cd-user-modal-container .cd-switcher li:first-child a{border-radius:.25em 0 0 0}.cd-user-modal-container .cd-switcher li:last-child a{border-radius:0 .25em 0 0}.cd-user-modal-container .cd-switcher a{font-size:1.2em;font-weight:bold;display:block;width:100%;height:50px;line-height:50px;background:#e8f1e2;color:#96b880}.cd-user-modal-container .cd-switcher a.selected{background:#FFF;color:#505260}@media only screen and (min-width:600px){.cd-user-modal-container{margin:4em auto}.cd-user-modal-container .cd-switcher a{height:70px;line-height:70px}}.cd-form{padding:1.4em}.cd-form .fieldset{position:relative;margin:1.4em 0}.cd-form .fieldset:first-child{margin-top:0}.cd-form .fieldset:last-child{margin-bottom:0}.cd-form label{font-size:16px;font-size:.875rem}.cd-form label.image-replace{display:inline-block;position:absolute;left:15px;top:50%;bottom:auto;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);-o-transform:translateY(-50%);transform:translateY(-50%);height:20px;width:20px;overflow:hidden;text-indent:100%;white-space:nowrap;color:transparent;text-shadow:none;background-repeat:no-repeat;background-position:50% 0}.cd-form label.cd-username{background-image:url("/wp-content/themes/runoob/assets/img/cd-icon-username.svg")}.cd-form label.cd-email{background-image:url("/wp-content/themes/runoob/assets/img/cd-icon-email.svg")}.cd-form label.cd-password{background-image:url("/wp-content/themes/runoob/assets/img/cd-icon-password.svg")}.cd-form input{margin:0;padding:0;border-radius:.25em}.cd-form input.full-width{width:80%}.cd-form input.full-width2{width:94%}.cd-form input.has-padding{padding:12px 20px 12px 50px}.cd-form input.has-border{border:1px solid #d2d8d8;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;-o-appearance:none;appearance:none}.cd-form input.has-border:focus{border-color:#98b880;box-shadow:0 0 5px rgba(52,54,66,0.1);outline:0}.cd-form input.has-error{border:1px solid #d76666}.cd-form input[type=password]{padding-right:65px}.cd-form input[type=submit]{padding:16px 0;cursor:pointer;background:#96b97d;color:#FFF;font-weight:bold;border:0;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;-o-appearance:none;appearance:none;font-size:1.2em;font-weight:bold}.no-touch .cd-form input[type=submit]:hover,.no-touch .cd-form input[type=submit]:focus{background:#3599ae;outline:0}@media only screen and (min-width:600px){.cd-form{padding:2em}.cd-form .fieldset{margin:2em 0}.cd-form .fieldset:first-child{margin-top:0}.cd-form .fieldset:last-child{margin-bottom:0}.cd-form input.has-padding{padding:16px 20px 16px 50px}.cd-form input[type=submit]{padding:16px 0}}.cd-close-form{display:block;position:absolute;width:40px;height:40px;right:0;top:-40px;background:url("/wp-content/themes/runoob/assets/img/cd-icon-close.svg") no-repeat center center;text-indent:100%;white-space:nowrap;overflow:hidden}@media only screen and (min-width:1170px){}#cd-login,#cd-signup,#cd-reset-password{display:none}#cd-login.is-selected,#cd-signup.is-selected,#cd-reset-password.is-selected{display:block}
</style>


</body></html>
